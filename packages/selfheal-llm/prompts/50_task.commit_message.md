# Task: Generate Commit Message

Create a clear, descriptive commit message that follows conventional commit standards and accurately describes the changes made.

## Commit Message Structure

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

### Type Categories

- **fix**: Bug fixes and error corrections
- **feat**: New features or enhancements
- **refactor**: Code restructuring without changing functionality
- **test**: Adding or updating tests
- **docs**: Documentation changes
- **style**: Code formatting and style changes
- **perf**: Performance improvements
- **ci**: CI/CD configuration changes
- **build**: Build system or dependency changes
- **chore**: Maintenance tasks and housekeeping

### Scope Guidelines

Common scopes for this project:

- **api**: API-related changes
- **auth**: Authentication/authorization
- **db**: Database changes
- **config**: Configuration updates
- **deps**: Dependency updates
- **types**: TypeScript type definitions
- **test**: Test-related changes
- **docs**: Documentation updates

## Message Guidelines

### Description (Required)

- Use imperative mood ("fix bug" not "fixed bug")
- Start with lowercase letter
- No period at the end
- Maximum 50 characters
- Be specific and concise

### Body (Optional)

- Explain what and why, not how
- Wrap at 72 characters
- Separate from description with blank line
- Use bullet points for multiple changes

### Footer (Optional)

- Reference related issues
- Note breaking changes
- Include co-authors if applicable

## Examples

### Bug Fix

```
fix(api): handle null response in user endpoint

- Add null check before processing user data
- Return appropriate error message for invalid responses
- Update error handling to prevent crashes

Fixes #123
```

### Feature Addition

```
feat(auth): add JWT token refresh mechanism

Implement automatic token refresh for expired JWT tokens:
- Add refresh token endpoint
- Update authentication middleware
- Handle token expiration gracefully
- Add refresh token storage

Closes #456
```

### Breaking Change

```
feat(api)!: update user model schema

BREAKING CHANGE: User model now requires email validation
- Add email field validation
- Update existing user migration
- Modify API response format

Closes #789
```

### Refactoring

```
refactor(utils): extract common validation logic

- Move validation functions to shared utility
- Remove duplicate validation code
- Improve type safety for validators
- Add comprehensive tests for validation utilities
```

## Self-Healing Context

For self-healing related commits, use these patterns:

### Automated Fix

```
fix(selfheal): resolve type mismatch in user service

Automated fix for TypeScript compilation error:
- Add missing type annotation for user parameter
- Update interface to match expected structure
- Ensure backward compatibility

Generated by: SelfHeal-LLM
Issue: #AUTO-001
```

### Test Generation

```
test(selfheal): add regression tests for user validation

Generated comprehensive test suite:
- Cover edge cases for null/undefined inputs
- Test error handling scenarios
- Validate fix for user validation bug
- Ensure no performance regression

Generated by: SelfHeal-LLM
Related to: #AUTO-001
```

### Configuration Fix

```
fix(config): correct database connection timeout

Automated configuration adjustment:
- Increase connection timeout from 5s to 30s
- Add retry mechanism for failed connections
- Update environment variable defaults

Generated by: SelfHeal-LLM
Resolves: #AUTO-002
```

## Validation Checklist

Before finalizing the commit message:

- [ ] Type is appropriate for the change
- [ ] Scope accurately describes the affected area
- [ ] Description is clear and concise
- [ ] Imperative mood is used
- [ ] Body explains the "why" not just the "what"
- [ ] Related issues are referenced
- [ ] Breaking changes are clearly marked
- [ ] Character limits are respected

## Template for Self-Healing

```
<type>(selfheal): <brief description of fix>

Automated resolution of <issue type>:
- <specific change 1>
- <specific change 2>
- <specific change 3>

Root cause: <explanation of what caused the issue>
Solution: <explanation of how it was resolved>
Impact: <description of what this fixes>

Generated by: SelfHeal-LLM
Auto-Issue: #<unique identifier>
[Closes|Fixes|Resolves]: #<original issue if applicable>
```

## Specialized DbC Patch Commit Messages

### Task: Produce a concise Conventional Commit message for the patch

For Design by Contract-based patches, generate focused commit messages:

**Inputs:**

- RULE: `{{rule}}`
- FILE: `{{filePath}}`
- SYMPTOM: `{{symptom}}` // e.g., "TypeError: cannot read property 'x' of undefined"
- FINGERPRINT: `{{fingerprint}}`

**Output (single line title + short body):**

```git
feat(self-heal): guard {{rule}} in {{filePath}} ({{fingerprint}})
- Adds DbC check and early return with typed error
- Aligned with analyzer rules; regression test included
```

**DbC Commit Message Patterns:**

**Null Reference Fixes:**

```git
fix(self-heal): guard null in {{filePath}} ({{fingerprint}})
- Add assertNonNull check at function entry
- Prevent TypeError: cannot read property of undefined
- Include regression test for null input validation
```

**Division by Zero Fixes:**

```git
fix(self-heal): guard divzero in {{filePath}} ({{fingerprint}})
- Add divisor validation before arithmetic operation
- Prevent division by zero error in calculation
- Handle negative zero and infinity edge cases
```

**Array Bounds Fixes:**

```git
fix(self-heal): guard oob in {{filePath}} ({{fingerprint}})
- Add index range validation with assertIndexInRange
- Prevent array access violation and undefined behavior
- Include boundary condition testing
```

**NaN Validation Fixes:**

```git
fix(self-heal): guard nan in {{filePath}} ({{fingerprint}})
- Add assertNumberFinite check for arithmetic inputs
- Prevent NaN propagation in calculations
- Handle Infinity and invalid number cases
```

**Unreachable Code Fixes:**

```git
fix(self-heal): guard unreachable in {{filePath}} ({{fingerprint}})
- Add fail() assertion for impossible code paths
- Improve error handling with typed error codes
- Ensure exhaustive pattern matching coverage
```

**Template Variables:**

- `{{rule}}`: DbC rule type (null, divzero, oob, nan, unreachable)
- `{{filePath}}`: Relative path to the fixed file
- `{{symptom}}`: Original error message or symptom
- `{{fingerprint}}`: Unique identifier for the fix

**Characteristics:**

- **Concise**: Single line title with 2-3 bullet body
- **Specific**: Mentions exact DbC rule and file
- **Traceable**: Includes fingerprint for tracking
- **Descriptive**: Explains what was added and why
- **Standards-Compliant**: Follows conventional commit format

## Message Quality Standards

### Good Examples

- Clear and specific
- Explains the impact
- References related work
- Follows conventional format

### Poor Examples

- Vague descriptions ("fix stuff")
- Missing context
- Incorrect type classification
- Too verbose or too brief
